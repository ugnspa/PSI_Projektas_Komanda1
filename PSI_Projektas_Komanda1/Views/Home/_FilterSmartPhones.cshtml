@*@using Microsoft.AspNetCore.Http
@using PSI_Projektas_Komanda1.Models
@{
    decimal minprice = 0;
    decimal maxprice = 0;
    if (Model.Count > 0)
    {
        minprice = decimal.MaxValue;
        maxprice = 0;
        foreach (Item item in Model)
        {
            if (item.Price > maxprice)
                maxprice = item.Price;
            if (item.Price < minprice)
            {
                minprice = item.Price;
            }
        }
    }
}

<div style="flex: 1; position: fixed; top: 50%; left: 1%; transform: translateY(-50%);">
    <form id="price-filter-form" action="@Url.Action("FilterSmartPhone", "Home")" method="post">
        <label for="min-price-input">Minimum price:</label><br>
        <input class="form-control" type="number" id="min-price-input" name="minvalue" value=@Html.Raw(maxprice)><br><br>

        <label for="max-price-input">Maximum price:</label><br>
        <input class="form-control" type="number" id="max-price-input" name="maxvalue" value="@Html.Raw(maxprice)"><br><br>

        <input class="btn btn-primary" type="submit" value="Filter" />
    </form>
</div>*@
@model List<Item>
<head>
    <link rel="stylesheet" href="~/css/filter.css" asp-append-version="true" />
</head>
@using (Html.BeginForm("FilterSmartPhones", "Home", FormMethod.Post, new { id = "filterForm" }))
{
    <div class="filter-container" >
        @*<button class="btn btn-primary" onclick="location.href='@Url.Action("Computers", "Home")'">Clear Filter</button><br>

    <br>*@


        <label style="font-size: 18px; font-weight: bold;">Filter by Price</label><br>
        @foreach (var mod in ViewBag.Prices)
        {
            <input type="checkbox" name="selectedPrices" value="@mod" id="@mod" class="brand-checkbox" ) />
            <label for="@mod">@mod</label>
            <br />
        }
        <br>

        <label style="font-size: 18px; font-weight: bold;">Filter by brand:</label><br>
        @{
            //ViewBag.Computers = Model.ToList();
        }
        @if (Model is List<Item> computers)
        {
            List<string> processors = new List<string>();
            List<string> gpu = new List<string>();
            List<int> Ram = new List<int>();
            List<int> memory = new List<int>();
            @foreach (var computer in computers)
            {
                if (computer is Smartphone comp)
                {
                    if (!processors.Contains(comp.Processor))
                        processors.Add(comp.Processor);
                    if (!gpu.Contains(comp.GPU))
                        gpu.Add(comp.GPU);
                    if (!Ram.Contains(comp.Ram))
                        Ram.Add(comp.Ram);
                    if (!memory.Contains(comp.Memory))
                        memory.Add(comp.Memory);
                }
            }
            @foreach (var brand in computers.Select(c => c.Brand).Distinct())
            {
                <input type="checkbox" name="selectedBrands" value="@brand" id="@brand" class="brand-checkbox" />
                <label for="@brand">@brand</label>
                <br />
            }
            <br>
            <label style="font-size: 18px; font-weight: bold;">Filter by Model</label>

            <br>
            @foreach (var mod in computers.Select(c => c.Model).Distinct())
            {
                <input type="checkbox" name="selectedModels" value="@mod" id="@mod" class="brand-checkbox" ) />
                <label for="@mod">@mod</label>
                <br />
            }
            <br>
            <label style="font-size: 18px; font-weight: bold;">Filter by Processor</label>

            <br>
            @foreach (var proc in processors)
            {
                <input type="checkbox" name="selectedProcessors" value="@proc" id="@proc" class="brand-checkbox" ) />
                <label for="@proc">@proc</label>
                <br />
            }
            <br>
            <label style="font-size: 18px; font-weight: bold;">Filter by GPU</label>

            <br>
            @foreach (var proc in gpu)
            {
                <input type="checkbox" name="selectedGpu" value="@proc" id="@proc" class="brand-checkbox" ) />
                <label for="@proc">@proc</label>
                <br />
            }
            <br>
            <label style="font-size: 18px; font-weight: bold;">Filter by Ram</label>

            <br>
            @foreach (var proc in Ram)
            {
                <input type="checkbox" name="selectedRam" value="@proc" id="@proc" class="brand-checkbox" ) />
                <label for="@proc">@proc GB</label>
                <br />
            }
            <br>
            <label style="font-size: 18px; font-weight: bold;">Filter by Memory</label>
            <br>
            @foreach (var proc in memory)
            {
                <input type="checkbox" name="selectedMemory" value="@proc" id="@proc" class="brand-checkbox" ) />
                <label for="@proc">@proc GB</label>
                <br />
            }
            <br>
        }



        @*<input type="checkbox" name="selectedBrands" value="@brand" id="@brand" class="brand-checkbox" ) />
    <label for="@brand">@brand</label>
    <br />*@

        <br />
        <button class="btn btn-primary" type="submit" id="filterButton">Filter</button>
    </div>
}

<script>
    $(document).ready(function () {
        // Submit form when filter button is clicked
        $("#filterButton").on("click", function () {
            $("#filterForm").submit();
        });
    });
</script>